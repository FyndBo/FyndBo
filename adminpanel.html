<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FyndBo Adminpanel</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
:root{
  --primary:#1e5fa5;
  --primary-dark:#144a85;
  --bg:#f5f8fc;
  --panel:#ffffffcc;
  --stroke:#e6eef7;
  --shadow:0 6px 18px rgba(0,0,0,.08);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:'Poppins',sans-serif;
  background:var(--bg);
  color:#0f1b2d;
  min-height:100vh;
}

/* HEADER */
.header{
  position:sticky;
  top:0;
  z-index:50;
  background:linear-gradient(135deg,#2a6fc1 0%, #1e5fa5 60%, #1b4e88 100%);
  color:#fff;
  box-shadow:var(--shadow);
  padding:4px 0;
}
.header-inner{
  max-width:1200px;
  margin:0 auto;
  padding:8px 22px;
  display:flex;
  align-items:center;
  justify-content:space-between;
}
.brand{
  display:flex;
  align-items:center;
  gap:14px;
  cursor:pointer;
}
.brand img{
  height:100px; /* större logga */
  transition:.2s;
  filter:drop-shadow(0 4px 10px rgba(0,0,0,.25));
}
.brand img:hover{transform:scale(1.05)}
.brand h1{
  margin:0;
  font-size:1.2rem;
  font-weight:600;
  letter-spacing:.3px;
  opacity:.95;
}
.btn{
  appearance:none;
  border:0;
  border-radius:999px;
  padding:8px 18px;
  font-weight:600;
  cursor:pointer;
  transition:.2s;
}
.btn-ghost{
  background:#ffffff;
  color:var(--primary);
}
.btn-ghost:hover{
  background:transparent;
  color:#fff;
  outline:2px solid #fff;
}

/* LAYOUT */
.shell{
  max-width:1200px;
  margin:24px auto;
  padding:0 22px;
  display:grid;
  grid-template-columns:260px 1fr;
  gap:24px;
}

/* SIDEBAR */
.sidebar{
  background:var(--panel);
  backdrop-filter:saturate(140%) blur(6px);
  border:1px solid var(--stroke);
  border-radius:18px;
  box-shadow:var(--shadow);
  padding:18px 0;
}
.sb-title{
  padding:0 18px 6px;
  color:var(--primary);
  font-weight:700;
  font-size:.95rem;
  letter-spacing:.6px;
}
.sb-group{margin-top:14px}
.sb-group .title{
  padding:10px 18px;
  font-weight:700;
  color:var(--primary);
  text-transform:uppercase;
  font-size:.8rem;
  letter-spacing:.8px;
}
.nav{
  display:flex;
  flex-direction:column;
  gap:4px;
  padding:4px 8px 10px;
}
.nav a{
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px 12px;
  margin:0 8px;
  border-radius:10px;
  color:#0f1b2d;
  text-decoration:none;
  transition:.15s;
  font-weight:500;
}
.nav a:hover{
  background:#eaf3ff;
  color:var(--primary);
}
.nav .empty{
  opacity:.6;
  padding:6px 18px;
}

/* MAIN */
.main{
  display:flex;
  flex-direction:column;
  gap:18px;
}
.welcome{
  background:var(--panel);
  border:1px solid var(--stroke);
  border-radius:18px;
  box-shadow:var(--shadow);
  padding:18px 22px;
}

/* CARDS */
.kpis{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:20px;
}
.card{
  background:#fff;
  border:1px solid var(--stroke);
  border-radius:16px;
  box-shadow:var(--shadow);
  transition:.2s;
  padding:18px;
  text-align:center;
  cursor:pointer;
  text-decoration:none;
  color:inherit;
}
.card:hover{
  transform:translateY(-3px);
  box-shadow:0 8px 20px rgba(0,0,0,.1);
}
.card i{
  font-size:2rem;
  color:var(--primary);
  margin-bottom:10px;
}
.card h3{
  margin:0 0 6px;
  color:var(--primary);
  font-size:1.05rem;
}
.card p{
  margin:0;
  color:#445063;
  font-size:.93rem;
}

/* FORM */
.panel{
  background:#fff;
  border:1px solid var(--stroke);
  border-radius:16px;
  box-shadow:var(--shadow);
  padding:20px;
  max-width:520px;
}
.input, .select{
  width:100%;
  padding:10px 12px;
  border:1px solid #cfe0f4;
  border-radius:10px;
  background:#f7fbff;
  outline:none;
  font-size:.95rem;
  transition:.15s;
}
.input:focus, .select:focus{
  border-color:#9cc3ef;
  background:#fff;
  box-shadow:0 0 0 3px #cfe6ff;
}
.btn-primary{
  background:var(--primary);
  color:#fff;
}
.btn-primary:hover{
  background:var(--primary-dark);
}
.msg{
  font-weight:600;
  margin-top:6px;
  font-size:.9rem;
}

/* FOOTER */
.footer{
  padding:22px 0 34px;
  text-align:center;
  color:#5a6a85;
  font-size:.9rem;
}

@media (max-width:1024px){
  .shell{grid-template-columns:1fr}
}
</style>
</head>
<body>

<!-- HEADER -->
<div class="header">
  <div class="header-inner">
    <div class="brand" id="logoLink">
      <img src="images/black_fyndbologo.png" alt="FyndBo logo">
      <h1>Adminpanel</h1>
    </div>
    <button class="btn btn-ghost" onclick="logout()">Logga ut</button>
  </div>
</div>

<!-- PAGE -->
<div class="shell" id="adminPanel" style="display:none;">
  <aside class="sidebar">
    <div class="sb-title">Navigation</div>

    <div class="sb-group">
      <div class="title"><i class="fa-regular fa-folder-open"></i> Sidor</div>
      <nav id="nav-sidor" class="nav"><div class="empty">Laddar...</div></nav>
    </div>

    <div class="sb-group">
      <div class="title"><i class="fa-solid fa-gear"></i> Hantering</div>
      <nav id="nav-hantering" class="nav"><div class="empty">Laddar...</div></nav>
    </div>

    <div class="sb-group">
      <div class="title"><i class="fa-solid fa-envelope"></i> Meddelanden</div>
      <nav id="nav-medd" class="nav"><div class="empty">Laddar...</div></nav>
    </div>
  </aside>

  <main class="main">
    <section class="welcome">
      <h2 style="margin:0;color:var(--primary)">Välkommen till FyndBos Adminpanel</h2>
      <div id="statusMsg" style="color:#4b5563">Ansluter till databasen…</div>
    </section>

    <section class="kpis">
      <a href="bostader.html" class="card">
        <i class="fa-solid fa-house"></i>
        <h3>Hantera bostäder</h3>
        <p>Lägg till, redigera eller ta bort bostäder.</p>
      </a>
      <a href="anvandare.html" class="card">
        <i class="fa-solid fa-users"></i>
        <h3>Användare</h3>
        <p>Se registrerade användare och administratörer.</p>
      </a>
      <a href="statistik.html" class="card">
        <i class="fa-solid fa-chart-line"></i>
        <h3>Statistik</h3>
        <p>Visa webbplatsdata och sidvisningar.</p>
      </a>
      <a href="nyttobjekt.html" class="card">
        <i class="fa-solid fa-plus"></i>
        <h3>Lägg till nytt objekt</h3>
        <p>Publicera en ny annons.</p>
      </a>
    </section>

    <section class="panel">
      <h3 style="margin:0 0 10px;color:var(--primary)">Lägg till ny sida</h3>
      <form id="addPageForm">
        <input class="input" type="text" id="newPageName" placeholder="Sidnamn (t.ex. Kontakt)" required>
        <input class="input" type="text" id="newPageUrl" placeholder="URL (t.ex. kontakt.html)" required>
        <select class="select" id="newPageCategory" required>
          <option value="">Välj kategori…</option>
          <option value="sidor">Sidor</option>
          <option value="hantering">Hantering</option>
          <option value="meddelanden">Meddelanden</option>
        </select>
        <button type="submit" class="btn btn-primary">Lägg till sida</button>
        <div id="addPageMsg" class="msg"></div>
      </form>
    </section>
  </main>
</div>

<div class="footer">© 2025 FyndBo – Adminpanel</div>

<!-- Supabase Script -->
<script type="module">
import { createClient } from "https://esm.sh/@supabase/supabase-js@2";
const supabase = createClient(
  "https://ymqwoiuhummwrtzfhbgm.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InltcXdvaXVodW1td3J0emZoYmdtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEzMDYzOTAsImV4cCI6MjA3Njg4MjM5MH0.9s0iaJm_RGJxZFyPZqQyZvPCeCz60Q6P8EsPxfSO2AI"
);
const navSidor=document.getElementById("nav-sidor"),
navHan=document.getElementById("nav-hantering"),
navMedd=document.getElementById("nav-medd"),
statusMsg=document.getElementById("statusMsg");
async function loadPages(){
  const {data,error}=await supabase.from("pages").select("*").order("name",{ascending:true});
  if(error){statusMsg.textContent="❌ Fel vid anslutning.";return;}
  const cleaned=(data||[]).filter(p=>(p.url||"").toLowerCase()!=="adminpanel.html");
  cleaned.forEach(p=>{if(p.category==="publik")p.category="sidor"});
  const item=(p)=>`<a href="${p.url}" target="_blank"><i class="fa-solid fa-file"></i>${p.name}</a>`;
  const group=(list,el)=>{el.innerHTML=list.length?list.map(item).join(""):`<div class="empty">Inga sidor.</div>`;}
  group(cleaned.filter(p=>p.category==="sidor"),navSidor);
  group(cleaned.filter(p=>p.category==="hantering"),navHan);
  group(cleaned.filter(p=>p.category==="meddelanden"),navMedd);
  statusMsg.textContent="✅ Sidor hämtade från databasen!";
}
document.addEventListener("DOMContentLoaded",loadPages);
document.getElementById("addPageForm").addEventListener("submit",async e=>{
  e.preventDefault();
  const name=document.getElementById("newPageName").value.trim();
  const url=document.getElementById("newPageUrl").value.trim();
  const category=document.getElementById("newPageCategory").value.trim();
  const msg=document.getElementById("addPageMsg");
  if(!name||!url||!category){msg.textContent="⚠️ Fyll i alla fält.";msg.style.color="#c62828";return;}
  const {error}=await supabase.from("pages").insert([{name,url,category}]);
  if(error){msg.textContent="❌ Kunde inte lägga till.";msg.style.color="#c62828";}
  else{msg.textContent="✅ Sidan lades till!";msg.style.color="#1b5e20";e.target.reset();loadPages();}
});
</script>

<!-- Login Script -->
<script>
const _u=atob("RnluZGJvLUFkbWlu"),_p=atob("RnluZEJvLTE=");
if(localStorage.getItem("loggedIn")==="true"){
  document.getElementById("adminPanel").style.display="grid";
}
function logout(){
  localStorage.removeItem("loggedIn");
  location.reload();
}
document.getElementById("logoLink").addEventListener("click",()=>{window.location.href="index.html";});
</script>
</body>
</html>
